<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Class of 2026</title>
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    rel="stylesheet"
  />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      transition: background-color 0.3s, color 0.3s;
    }
    body.light {
      background-color: #f5f5f5;
      color: #202020;
    }
    .card {
      background: #1e1e1e;
      border-radius: 16px;
      padding: 2rem 2.5rem;
      box-shadow: 0 8px 24px rgba(0,0,0,0.6);
      max-width: 400px;
      width: 90vw;
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
      transition: background 0.3s, color 0.3s;
      position: relative;
      z-index: 10;
    }
    body.light .card {
      background: #fff;
      color: #202020;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
    }
    h1 {
      margin: 0 0 0.25em 0;
      font-weight: 700;
    }
    .countdown {
      font-size: 1.8rem;
      min-height: 2.5em;
    }
    .quips {
      font-style: italic;
      color: #f9d71c; /* bright yellow */
      min-height: 1.8em;
    }
    progress {
      width: 100%;
      height: 20px;
      border-radius: 10px;
      appearance: none;
      -webkit-appearance: none;
      background-color: #333;
      margin-bottom: 0.25em;
      transition: background-color 0.3s;
    }
    progress::-webkit-progress-bar {
      background-color: #333;
      border-radius: 10px;
    }
    progress::-webkit-progress-value {
      background-color: #f9d71c;
      border-radius: 10px;
    }
    progress::-moz-progress-bar {
      background-color: #f9d71c;
      border-radius: 10px;
    }
    #percentage {
      font-weight: 600;
      font-size: 1.1rem;
      color: #f9d71c;
    }
    .btn-group {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 0.5rem;
    }
    button {
      background-color: #f9d71c;
      border: none;
      border-radius: 24px;
      padding: 0.6em 1.5em;
      font-weight: 600;
      cursor: pointer;
      color: #121212;
      transition: background-color 0.3s;
      user-select: none;
    }
    button:hover {
      background-color: #d4b30b;
    }
    #themeToggleBtn {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background-color: #f9d71c;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      border: none;
      cursor: pointer;
      color: #121212;
      font-size: 1.4rem;
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
      box-shadow: 0 3px 8px rgba(0,0,0,0.3);
      transition: background-color 0.3s;
      z-index: 20;
    }
    #themeToggleBtn:hover {
      background-color: #d4b30b;
    }
    /* Confetti canvas fills entire screen */
    #confetti-canvas {
      position: fixed;
      pointer-events: none;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 5;
    }
  </style>
</head>
<body>

  <div class="card" role="main" aria-label="Class of 2026 Countdown">
    <h1>Class of 2026</h1>
    <div class="countdown" id="countdown" aria-live="polite" aria-atomic="true">Loading...</div>
    <progress id="progressBar" value="0" max="100" aria-label="Progress"></progress>
    <div id="percentage" aria-live="polite" aria-atomic="true">0%</div>
    <div class="quips" id="quips" aria-live="polite" aria-atomic="true"></div>
    <div class="btn-group">
      <button id="testConfettiBtn" aria-label="Test Confetti Animation">Test Confetti</button>
      <button id="switchToGradBtn" aria-label="Switch between Summer and Graduation mode">Switch to Grad Mode</button>
    </div>
  </div>

  <button id="themeToggleBtn" aria-label="Toggle dark/light theme" title="Toggle dark/light theme">
    <i class="fas fa-moon" aria-hidden="true"></i>
  </button>

  <canvas id="confetti-canvas"></canvas>

<script>
(() => {
  const countdownEl = document.getElementById('countdown');
  const progressBar = document.getElementById('progressBar');
  const percentageEl = document.getElementById('percentage');
  const quipsEl = document.getElementById('quips');
  const testConfettiBtn = document.getElementById('testConfettiBtn');
  const switchToGradBtn = document.getElementById('switchToGradBtn');
  const themeToggleBtn = document.getElementById('themeToggleBtn');
  const confettiCanvas = document.getElementById('confetti-canvas');
  const ctx = confettiCanvas.getContext('2d');

  // Quips arrays
  const gradQuips = [
    "Getting ready for the tassel flip...",
    "Senioritis loading in 3... 2... 1...",
    "Almost time to toss that cap!",
    "You've got this, Class of '26!",
    "Keep grinding—freedom's near!",
    "Make it count—these are the last laps!",
    "Dream big, work hard, graduate proud!",
    "The tassel’s worth the hassle!",
    "Final countdown: make it legendary!",
    "One step closer to the stage!"
  ];

  const summerQuips = [
    "Summer vibes are in full swing!",
    "Suns out, funs out!",
    "Time to recharge before the big day!",
    "Enjoy the sunshine, Class of '26!",
    "Making memories before the tassel flip!",
    "Stay cool and dream big!",
    "Lazy days, bright future!",
    "Keep shining this summer!",
    "Relax now, hustle later!",
    "Summer breeze and bright degrees!"
  ];

  // Dates
  const now = new Date();
  const summerStart = new Date(now.getFullYear(), now.getMonth(), now.getDate()); // today
  const summerEnd = new Date(now.getFullYear(), 6, 28); // July 28 same year
  if (summerEnd < summerStart) {
    summerEnd.setFullYear(summerEnd.getFullYear() + 1);
  }
  const gradDate = new Date(2026, 4, 29); // May 29, 2026

  // State
  let mode = 'summer'; // or 'grad'
  let forcedMode = null; // null or 'summer' or 'grad'

  // Theme state
  function applyTheme(theme) {
    if (theme === 'light') {
      document.body.classList.add('light');
      themeToggleBtn.innerHTML = '<i class="fas fa-sun" aria-hidden="true"></i>';
      localStorage.setItem('theme', 'light');
    } else {
      document.body.classList.remove('light');
      themeToggleBtn.innerHTML = '<i class="fas fa-moon" aria-hidden="true"></i>';
      localStorage.setItem('theme', 'dark');
    }
  }
  // Init theme from localStorage or prefers-color-scheme
  let savedTheme = localStorage.getItem('theme');
  if (!savedTheme) {
    savedTheme = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
  }
  applyTheme(savedTheme);

  themeToggleBtn.addEventListener('click', () => {
    const newTheme = document.body.classList.contains('light') ? 'dark' : 'light';
    applyTheme(newTheme);
  });

  // Helper - format remaining time
  function formatTime(ms) {
    if (ms <= 0) return "00d 00h 00m 00s";
    const totalSeconds = Math.floor(ms / 1000);
    const days = Math.floor(totalSeconds / 86400);
    const hours = Math.floor((totalSeconds % 86400) / 3600);
    const minutes = Math.floor((totalSeconds % 3600) / 60);
    const seconds = totalSeconds % 60;
    return `${String(days).padStart(2,'0')}d ${String(hours).padStart(2,'0')}h ${String(minutes).padStart(2,'0')}m ${String(seconds).padStart(2,'0')}s`;
  }

  // Confetti particle
  class ConfettiParticle {
    constructor(x, y) {
      this.x = x;
      this.y = y;
      this.size = 6 + Math.random() * 4;
      this.speedX = (Math.random() - 0.5) * 3;
      this.speedY = Math.random() * 4 + 2;
      this.color = '#f9d71c';
      this.opacity = 1;
      this.rotation = Math.random() * 360;
      this.rotationSpeed = (Math.random() - 0.5) * 10;
      this.settled = false;
    }
    update() {
      if (!this.settled) {
        this.x += this.speedX;
        this.y += this.speedY;
        this.rotation += this.rotationSpeed;
        if (this.y >= window.innerHeight - this.size * 2) {
          this.y = window.innerHeight - this.size * 2;
          this.settled = true;
          this.speedX = 0;
          this.speedY = 0;
          this.rotationSpeed = 0;
        }
      } else {
        this.opacity -= 0.015;
        if (this.opacity < 0) this.opacity = 0;
      }
    }
    draw(ctx) {
      ctx.save();
      ctx.translate(this.x, this.y);
      ctx.rotate(this.rotation * Math.PI / 180);
      ctx.fillStyle = `rgba(249, 215, 28, ${this.opacity})`;
      ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size);
      ctx.restore();
    }
  }

  let confettiParticles = [];
  let confettiActive = false;

  function createConfettiExplosion() {
    confettiParticles = [];
    const count = 150;
    for (let i = 0; i < count; i++) {
      confettiParticles.push(new ConfettiParticle(window.innerWidth/2, window.innerHeight/4));
    }
    confettiActive = true;
  }

  function updateConfetti() {
    if (!confettiActive) return;
    ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
    confettiParticles.forEach(p => {
      p.update();
      p.draw(ctx);
    });
    confettiParticles = confettiParticles.filter(p => p.opacity > 0);
    if (confettiParticles.length === 0) {
      confettiActive = false;
      ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
      cancelAnimationFrame(animationId);
    } else {
      animationId = requestAnimationFrame(updateConfetti);
    }
  }

  function startConfetti() {
    if(confettiActive) return; // prevent multiple
    createConfettiExplosion();
    animationId = requestAnimationFrame(updateConfetti);
  }

  // Resize canvas
  function resizeCanvas() {
    confettiCanvas.width = window.innerWidth;
    confettiCanvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();

  // Update countdown + progress + quips
  function updateCountdown() {
    const now = new Date();
    let targetStart, targetEnd, targetName, quipsArray;

    if(forcedMode === 'summer' || (!forcedMode && now < summerEnd)) {
      mode = 'summer';
      targetStart = summerStart;
      targetEnd = summerEnd;
      targetName = "Summer Time";
      quipsArray = summerQuips;
      switchToGradBtn.textContent = "Switch to Grad Mode";
    } else {
      mode = 'grad';
      targetStart = summerEnd;
      targetEnd = gradDate;
      targetName = "Graduation Day";
      quipsArray = gradQuips;
      switchToGradBtn.textContent = "Switch to Summer Mode";
    }

    const totalDuration = targetEnd - targetStart;
    const elapsed = now - targetStart;
    const remaining = targetEnd - now;

    // Protect against negative values
    const clampedElapsed = Math.min(Math.max(elapsed, 0), totalDuration);
    const progressPercent = (clampedElapsed / totalDuration) * 100;

    countdownEl.textContent = `${targetName} in ${formatTime(remaining)}`;
    progressBar.value = progressPercent;
    percentageEl.textContent = `${progressPercent.toFixed(1)}%`;

    // Quip changes every 5 seconds approx
    const quipIndex = Math.floor(now.getTime() / 5000) % quipsArray.length;
    quipsEl.textContent = quipsArray[quipIndex];

    // If countdown is done for grad, show confetti
    if (remaining <= 0 && mode === 'grad' && !confettiActive) {
      startConfetti();
    }
  }

  // Initial call and interval
  updateCountdown();
  setInterval(updateCountdown, 1000);

  // Button handlers
  testConfettiBtn.addEventListener('click', () => {
    startConfetti();
  });

  switchToGradBtn.addEventListener('click', () => {
    if (forcedMode === 'summer') {
      forcedMode = 'grad';
    } else if (forcedMode === 'grad') {
      forcedMode = null; // auto mode
    } else {
      forcedMode = 'summer';
    }
    updateCountdown();
  });
})();
</script>

</body>
</html>