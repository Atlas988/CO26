<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Class of 2026 Countdown</title>

  <!-- Materialize CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet" />

  <!-- Roboto font -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

  <!-- Canvas Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    body {
      font-family: 'Roboto', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      transition: background 0.5s, color 0.5s;
      background-color: #121212;
      color: #eee;
      flex-direction: column;
      padding: 1rem;
      position: relative;
      overflow-x: hidden;
    }
    .card {
      padding: 2rem;
      border-radius: 12px;
      max-width: 550px;
      text-align: center;
      background: #1e1e1e;
      box-shadow: 0 8px 20px rgba(0,0,0,0.6);
      width: 100%;
      max-width: 600px;
      position: relative;
    }
    .time {
      font-size: 2.8rem;
      font-weight: 700;
      color: #90caf9;
      transition: color 0.5s;
    }
    .quip {
      font-size: 1.3rem;
      margin-top: 1rem;
      font-style: italic;
      opacity: 1;
      transition: opacity 0.8s ease;
      min-height: 40px;
      color: #fbc02d;
    }
    .progress-container {
      margin-top: 2rem;
      text-align: left;
    }
    .progress-label {
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: #90caf9;
      transition: color 0.5s;
    }
    .progress {
      background-color: #333;
      border-radius: 20px;
      overflow: hidden;
      height: 20px;
    }
    .determinate {
      background-color: #42a5f5;
      height: 100%;
      width: 0;
      transition: width 1.5s ease-out;
    }
    body.day-theme {
      background-color: #f5f5f5;
      color: #333;
    }
    body.day-theme .card {
      background: white;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }
    body.day-theme .time {
      color: #1976d2;
    }
    body.day-theme .progress-label {
      color: #1976d2;
    }
    body.day-theme .progress {
      background-color: #eee;
    }
    body.day-theme .determinate {
      background-color: #1976d2;
    }
    body.night-theme {
      background-color: #121212;
      color: #eee;
    }
    body.night-theme .card {
      background: #1e1e1e;
    }
    body.night-theme .time {
      color: #90caf9;
    }
    body.night-theme .progress-label {
      color: #90caf9;
    }
    body.night-theme .progress {
      background-color: #333;
    }
    body.night-theme .determinate {
      background-color: #42a5f5;
    }
    #mode-toggle {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 1rem;
      border: none;
      border-radius: 25px;
      background-color: #42a5f5;
      color: white;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(66,165,245,0.5);
      transition: background-color 0.3s ease;
      margin-right: 10px;
    }
    #mode-toggle:hover {
      background-color: #1e88e5;
    }
    #daily-quote {
      margin-top: 20px;
      font-style: normal;
      font-weight: 600;
      font-size: 1.1rem;
      max-width: 600px;
      text-align: center;
      color: #fbc02d;
      text-shadow: 0 0 8px rgba(251, 192, 45, 0.7);
      min-height: 44px;
      transition: opacity 0.8s ease;
    }

    /* Theme toggle fixed button bottom left */
    #theme-toggle {
      position: fixed;
      bottom: 15px;
      left: 15px;
      background-color: #42a5f5;
      border: none;
      cursor: pointer;
      font-size: 1.8rem;
      color: #fbc02d;
      transition: background-color 0.3s ease, color 0.3s ease;
      z-index: 9999;
      user-select: none;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(66,165,245,0.5);
      padding: 0;
    }
    #theme-toggle:hover {
      color: #fff176;
      background-color: #1976d2;
    }
  </style>
</head>
<body class="night-theme">
  <div class="card z-depth-3" role="main" aria-live="polite">
    <h4 id="mode-title">Graduation in</h4>
    <div class="time" id="countdown">Loading...</div>
    <div class="quip" id="quip">Getting ready for the tassel flip...</div>
    <div class="progress-container" aria-label="Progress towards graduation">
      <div class="progress-label" id="progress-percent">0% complete</div>
      <div class="progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
        <div class="determinate" id="progress-bar" style="width: 0%"></div>
      </div>
    </div>
  </div>

  <button id="mode-toggle" aria-pressed="false" aria-label="Toggle between Graduation and Summer countdown">Toggle Mode</button>

  <div id="daily-quote" aria-live="polite"></div>

  <!-- Theme toggle with Font Awesome icon bottom-left -->
  <button id="theme-toggle" aria-label="Toggle theme (dark/light)" title="Toggle theme">
    <i id="theme-icon" class="fas fa-moon"></i>
  </button>

  <script>
    const graduationDate = new Date("2026-05-29T10:00:00");
    const schoolStartDate = new Date("2025-07-28T00:00:00");
    const summerStartDate = new Date("2025-05-30T00:00:00");
    const summerEndDate = new Date("2025-07-28T00:00:00");

    const quips = [
      "Getting ready for the tassel flip...",
      "Senioritis loading in 3... 2... 1...",
      "College apps and coffee, anyone?",
      "Remember when 2026 felt forever away?",
      "Almost time to toss that cap!",
      "Is it too early to cry happy tears?",
      "Caps, gowns, and goodbyes coming soon.",
      "You've got this, Class of '26!",
      "Keep grinding—freedom's near!",
      "Make it count—these are the last laps!"
    ];

    const motivationalQuotes = [
      "Believe you can and you're halfway there.",
      "Every accomplishment starts with the decision to try.",
      "Don't watch the clock; do what it does. Keep going.",
      "Success is the sum of small efforts repeated day in and day out.",
      "Dream big. Work hard. Stay focused.",
      "The future belongs to those who believe in the beauty of their dreams.",
      "Push yourself, because no one else is going to do it for you.",
      "Mistakes are proof that you are trying.",
      "Success doesn’t come from what you do occasionally, it comes from what you do consistently.",
      "Your limitation—it’s only your imagination."
    ];

    let currentMode = 'graduation'; // or 'summer'
    let quipIndex = 0;
    let hasCelebrated = false;
    let lastConfettiMinute = null;
    let manualTheme = 'night';

    // Helper to get full days between ignoring time-of-day issues
    function daysBetween(date1, date2) {
      const utc1 = Date.UTC(date1.getFullYear(), date1.getMonth(), date1.getDate());
      const utc2 = Date.UTC(date2.getFullYear(), date2.getMonth(), date2.getDate());
      const msPerDay = 24 * 60 * 60 * 1000;
      return Math.floor((utc2 - utc1) / msPerDay);
    }

    function updateCountdown() {
      const now = new Date();
      let targetDate, startDate, modeLabel;

      if (currentMode === 'graduation') {
        targetDate = graduationDate;
        startDate = schoolStartDate;
        modeLabel = "Graduation in";
      } else {
        targetDate = summerEndDate;
        startDate = summerStartDate;
        modeLabel = "Summer ends in";
      }

      // Strip times for days calculation to get full days left
      const nowDateOnly = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      const targetDateOnly = new Date(targetDate.getFullYear(), targetDate.getMonth(), targetDate.getDate());

      const totalDays = daysBetween(nowDateOnly, targetDateOnly);

      // Calculate hours, minutes, seconds left *today*
      const endOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 0, 0, 0, 0);
      let msLeftToday = targetDate - now;
      if (msLeftToday < 0) msLeftToday = 0;

      const hours = Math.floor(msLeftToday / (1000 * 60 * 60)) % 24;
      const minutes = Math.floor(msLeftToday / (1000 * 60)) % 60;
      const seconds = Math.floor(msLeftToday / 1000) % 60;

      // Show days + time left in HH:MM:SS
      let countdownText;
      if (totalDays > 0) {
        countdownText = `${totalDays} day${totalDays !== 1 ? 's' : ''}, ${hours.toString().padStart(2, '0')}:` +
                        `${minutes.toString().padStart(2, '0')}:` +
                        `${seconds.toString().padStart(2, '0')}`;
      } else {
        countdownText = `${hours.toString().padStart(2, '0')}:` +
                        `${minutes.toString().padStart(2, '0')}:` +
                        `${seconds.toString().padStart(2, '0')}`;
      }

      document.getElementById('countdown').textContent = countdownText;
      document.getElementById('mode-title').textContent = modeLabel;

      // Progress calculation (0 to 100%)
      const totalPeriodDays = daysBetween(startDate, targetDate);
      const elapsedDays = daysBetween(startDate, nowDateOnly);
      let percentComplete = 0;
      if (elapsedDays >= 0 && totalPeriodDays > 0) {
        percentComplete = Math.min(100, Math.max(0, (elapsedDays / totalPeriodDays) * 100));
      }
      document.getElementById('progress-bar').style.width = percentComplete + '%';
      document.getElementById('progress-bar').setAttribute('aria-valuenow', Math.floor(percentComplete));
      document.getElementById('progress-percent').textContent = `${Math.floor(percentComplete)}% complete`;

      // Confetti once per full minute when seconds = 0
      if (seconds === 0 && lastConfettiMinute !== now.getMinutes()) {
        lastConfettiMinute = now.getMinutes();
        launchConfetti();
      }
    }

    // Quip rotation every 10 seconds with fade
    function rotateQuip() {
      const quipElem = document.getElementById('quip');
      quipElem.style.opacity = '0';
      setTimeout(() => {
        quipIndex = (quipIndex + 1) % quips.length;
        quipElem.textContent = quips[quipIndex];
        quipElem.style.opacity = '1';
      }, 800);
    }

    // Launch confetti from bottom center with fade out
    function launchConfetti() {
      const duration = 4000;
      const animationEnd = Date.now() + duration;
      const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 1000 };

      function frame() {
        // Emit confetti in bursts from bottom center
        confetti(Object.assign({}, defaults, {
          particleCount: 5,
          origin: { x: 0.5, y: 1 }
        }));

        if (Date.now() < animationEnd) {
          requestAnimationFrame(frame);
        }
      }
      frame();
    }

    // Daily motivational quote (changes each day)
    function updateDailyQuote() {
      const now = new Date();
      const index = now.getDate() % motivationalQuotes.length;
      document.getElementById('daily-quote').textContent = motivationalQuotes[index];
    }

    // Mode toggle button
    document.getElementById('mode-toggle').addEventListener('click', () => {
      currentMode = currentMode === 'graduation' ? 'summer' : 'graduation';
      document.getElementById('mode-toggle').setAttribute('aria-pressed', currentMode === 'summer');
      updateCountdown();
    });

    // Theme toggle button
    const themeToggleBtn = document.getElementById('theme-toggle');
    const themeIcon = document.getElementById('theme-icon');

    function setTheme(theme) {
      if (theme === 'day') {
        document.body.classList.remove('night-theme');
        document.body.classList.add('day-theme');
        themeIcon.classList.remove('fa-moon');
        themeIcon.classList.add('fa-sun');
      } else {
        document.body.classList.remove('day-theme');
        document.body.classList.add('night-theme');
        themeIcon.classList.remove('fa-sun');
        themeIcon.classList.add('fa-moon');
      }
      manualTheme = theme;
      localStorage.setItem('theme', theme);
    }

    themeToggleBtn.addEventListener('click', () => {
      if (manualTheme === 'night') {
        setTheme('day');
      } else {
        setTheme('night');
      }
    });

    // Load theme from localStorage or default to night
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'day') {
      setTheme('day');
    } else {
      setTheme('night');
    }

    // Initial quip setup
    document.getElementById('quip').textContent = quips[0];

    // Update countdown every second
    setInterval(updateCountdown, 1000);

    // Rotate quip every 10 seconds
    setInterval(rotateQuip, 10000);

    // Update daily quote once per load
    updateDailyQuote();

    // Initial call to populate countdown immediately
    updateCountdown();

  </script>
</body>
</html>